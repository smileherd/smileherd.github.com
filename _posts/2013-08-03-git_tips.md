---
layout: post
title: 给人看的 Git 小指南
---

从 git 出现的那天，svn 就老了。

固守着的人大多不是因为留恋，只是不愿迈动步子罢了。毕竟在这个行业里，像《重庆森林》里那条毛巾一样富有感情的人不多。

git 作为富二代，从出生脑袋上就顶着个 F1.4 的大光圈。老爹是 Linus Torvalds 就足以让一众小码农肝颤了，号称程序员的 facebook 的 Github 社区的火爆更是让 git 跃居一线明星。

** 有人不忿，说哪牛逼了？爹牛逼儿子就一定牛逼啊？说不定是芬兰版阿斗呢？ **

其实还真就没啥特牛逼的，既不能当早餐吃，也不能让地铁松快点。也就我们这帮傻鸟码农当回事，觉得哇塞！这是“革命”哇！革命确实是够革命的，毕竟革了 svn 的命。但作为码农，种出来的菜不好吃，锄头再革命性有什么用？

跑题了… 大体上 git 的优点一是快，因为基本都是本地操作；二是分布式，可在无网络环境工作；三是分支操作丝般顺滑，跟刚用潘婷洗过一样。还有一些细节改进，可以参见书里写的。

** 那到底哪变了？ **

git 与江湖前辈 svn 比起来，最大的不同在于所谓的分布式。

对于 svn 集中式管理来说，代码仓库托管在服务器上，是独一份的。git 则不同，是每个开发者都在本地有一份完整的代码仓库。代码提交也是提交到本地仓库的。

试图从 svn 迁移到 git 的同僚们开始的时候很容易困惑：都尼玛在本地，老子代码怎么上缴啊？怎么和小伙伴们配合啊？这是潜意识里拿 git 当 svn 使了，骨子里还没理解 git 的分布式特性。

从这个意义上说 git 远不如 svn 符合直觉。因为一般的开发流程是一小撮开发者都往同一个地方垒代码，最终做成一个完整的产品。这与 svn 的工作方式非常契合。同样的流程，使用 git 是这样的：每个人本地保存一份代码仓库，公司的 git 托管服务器（或者诸如 github 这样的公共 git 托管服务）上托管一份代码仓库，大伙通过服务器上的这份代码仓库来完成代码交换和集成。业务逻辑上来说，这份服务器上的代码仓库才真正与 svn 的代码仓库平起平坐，开发者本地的代码仓库地位上相当于 svn 的本地 checkout 到的文件目录。

智商不低于腰围的码农一般都会认为 svn 很容易上手，而 git 特受挫正是这个原因。集中式的协同开发思维与 svn 的模式丝丝合扣，实际上 svn 的实现正是基于这种开发思维的。反观 git 要实现类似的集中协同开发，则需要依靠制度上的约定。强大、自由的工具一般都这样，跟女神一个德行，不费点心思搞不定。

正是因为基于分布式，才带来了 git 的诸多优点。书上说到 git 操作本地化的时候，眉飞色舞的意淫在夏威夷的海滩上写代码时，没有 wifi 也可以畅快的提交代码啦！能讲出这么伤天害理的话，真想诅咒他一辈子不能离婚。

** 别扯没用的 **

你要一开始就从这行开始看，也忒不讲究了，没有前戏是不会幸福的…

那好，你要特别猴急的话，首先得搞个 git 仓库，可以从别的小伙伴那克隆一个：

	git clone git://github.com/jquery/jquery.git

这个克隆跟克隆多利羊不一样，这个克隆出来的东西跟原本是完完全全一样的，没有任何区别。

或者也可以踅摸一个现有项目，纳入 git 版本管理，初始化操作：

	git init /path/to/your/project-x

git 仓库根目录有一个隐藏的 .git 目录，这个 .git 目录保存着历朝历代的代码版本，所有的数据都保存于此。除此之外，纳入 git 版本管理的项目目录与一般目录没有任何区别，非常低调内敛。不像 svn 那样在每层目录下都建一个 .svn 目录，拷贝起来都特烦，必须 export 才成。

** 在本地仓库玩 **

与 svn 相比，git 在提交操作前多了个暂存（stage）的阶段。所谓暂存用人话说就是“准备提交”阶段，使用 add 命令将文件或目录加入暂存区。

	git add files-to-stage

不同于 svn add，svn 的 add 是将文件纳入版本跟踪。一个文件只需要 add 一次，以后每次改动后直接执行 commit 操作就会将此文件提交版本库。而 git add 的意思是将某个文件加入到**即将**（这两个字重读）提交的文件列表。所以对 git 而言，每次改动文件后，要执行 commit 操作就必须先 add 下。

那… 这有毛线用啊？

书上说是为了让你“精心准备要提交的细节”。就个人体会而言，主要在于提升逼格。

** 我想删除文件 **

如果是真删除（既从版本库里踢出去，又从硬盘上踢出去），这样：
	
	# 从硬盘上删除
	rm foo
	
	# 暂存删除操作
	git add foo
	# 或者
	git rm foo
	
	# 从版本库删除
	git commit -m 'delete foo'

也可以这样：

	# 从硬盘删除，并暂存删除操作
	git rm foo

	# 如果删除前修改过，需要 -f 选项
	git rm -f foo
		
	# 从版本库删除
	git commit -m 'delete foo'

如果只从版本库移除，即不再跟踪文件，但还在硬盘上保留的话，这样：

	# 暂存从版本库移除操作
	git rm --cached foo
	
	# 从版本库移除，不再纳入版本管理
	git commit -m 'delete and stop tracking foo from git'

** 我想看历史版本 **

	# -p 查看详情，--stat 查看简要统计，-n 查看最近 n 次提交
	git log
	
大部分 git 子命令都包括一系列可选参数，繁复缤纷之处几可比拟三星的手机型号。

** 我靠！打歪了！ **

> 人生，总有那么几次踩到大便的时候。  
